<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>ç¾¤æ„›ç…å­æœƒ - å‡ºå¸­ç°½åˆ°ç°¿</title>
    <style>
        /* --- å´é‚Šæ¬„å°ˆç”¨å„ªåŒ–æ¨£å¼ --- */
        
        /* åŠé€æ˜èƒŒæ™¯ï¼Œè®“ç°¡å ±åº•åœ–é€å‡ºä¾† */
        body { margin: 0; padding: 0; background-color: rgba(0,0,0,0.85); color: white; font-family: "Microsoft JhengHei", sans-serif; overflow: hidden; }
        
        /* æ¨™é¡Œå€ç¸®å°ï¼Œç¯€çœç©ºé–“ */
        .header { background: linear-gradient(90deg, #b48811 0%, #fbd050 100%); padding: 10px; display: flex; flex-direction: column; align-items: center; justify-content: center; height: auto; box-shadow: 0 2px 5px rgba(0,0,0,0.5); border-bottom: 2px solid #fff; }
        .title { font-size: 1.2rem; font-weight: 900; color: #4a3403; margin-bottom: 8px; text-shadow: 0 1px 0 rgba(255,255,255,0.3); }
        
        /* å³ä¸Šè§’è¨ˆæ•¸å™¨ */
        .counter-box { background-color: #fff; padding: 5px 15px; border-radius: 20px; color: #b48811; text-align: center; width: 80%; box-shadow: inset 0 2px 5px rgba(0,0,0,0.1); }
        .count-label { font-size: 0.8rem; font-weight: bold; color: #555; display: inline-block; margin-right: 5px; vertical-align: middle;}
        .count-number { font-size: 1.8rem; font-weight: 800; line-height: 1; display: inline-block; vertical-align: middle; color: #d32f2f; }
        
        /* åå–®å€ */
        .content { height: 85vh; padding: 10px; box-sizing: border-box; overflow-y: auto; }
        
        /* å¼·åˆ¶å–®æ¬„é¡¯ç¤º */
        .grid-container { display: flex; flex-direction: column; gap: 10px; padding-bottom: 50px; }
        
        /* åç‰‡å¡å„ªåŒ–ï¼šå­—é«”æ”¾å¤§ï¼Œé©æ‡‰çª„è¢å¹• */
        .card { background-color: rgba(255,255,255,0.1); border-left: 6px solid #fbd050; border-radius: 6px; padding: 12px 15px; text-align: left; position: relative; display: flex; align-items: center; justify-content: space-between; transition: all 0.3s; }
        .card.new-arrival { animation: flash 2s infinite; background-color: rgba(180, 136, 17, 0.4); }
        
        /* åå­—èˆ‡è·ç¨± */
        .info-group { display: flex; flex-direction: column; }
        .card-job { font-size: 0.85rem; color: #fbd050; font-weight: bold; margin-bottom: 2px; }
        .card-name { font-size: 1.6rem; font-weight: bold; color: #fff; line-height: 1.2; letter-spacing: 1px; } 
        
        /* è¦ªå‹å‚™è¨»æ”¹å°åœ“æ¨™ */
        .card-note { font-size: 0.75rem; color: #222; background: #fbd050; padding: 3px 8px; border-radius: 10px; font-weight: bold; margin-left: 10px; white-space: nowrap; }
        
        @keyframes flash { 0% { border-color: #fbd050; box-shadow: 0 0 5px #fbd050; } 50% { border-color: #fff; box-shadow: 0 0 15px #fbd050; } 100% { border-color: #fbd050; box-shadow: 0 0 5px #fbd050; } }
        
        #loading { text-align: center; color: #aaa; margin-top: 50px; font-size: 1.2rem; }
        
        /* éš±è—æ²è»¸ä½†ä¿ç•™åŠŸèƒ½ */
        .content::-webkit-scrollbar { width: 6px; }
        .content::-webkit-scrollbar-track { background: rgba(0,0,0,0.3); }
        .content::-webkit-scrollbar-thumb { background: #fbd050; border-radius: 3px; }
    </style>
</head>
<body>

    <div class="header">
        <div class="title">ğŸ¦ ç¾¤æ„›ç…å­æœƒ</div>
        <div class="counter-box">
            <div class="count-label">ç›®å‰å‡ºå¸­</div>
            <div class="count-number" id="totalCount">0</div>
        </div>
    </div>

    <div class="content">
        <div id="loading">é€£ç·šè³‡æ–™åº«ä¸­...</div>
        <div class="grid-container" id="grid">
            </div>
    </div>

    <script>
        // â˜…â˜…â˜… æ‚¨çš„ GAS ç¶²å€ (ç¶­æŒä¸è®Š) â˜…â˜…â˜…
        const GAS_URL = "https://script.google.com/macros/s/AKfycbyPT4Joi9U2kQisNsWEb-odpD-mifTcs1h44h60-fdwWh-ulh2l8bGHnXmtWn9Gy76Y/exec";
        
        // è¨­å®šæ¯ 5 ç§’æ›´æ–°ä¸€æ¬¡
        setInterval(fetchData, 5000);
        fetchData(); 

        let previousCount = 0;

        function fetchData() {
            fetch(GAS_URL + "?action=getDashboard")
            .then(res => res.json())
            .then(data => {
                render(data);
            })
            .catch(err => {
                console.error("æ›´æ–°å¤±æ•—", err);
                document.getElementById("loading").innerText = "é€£ç·šå¤±æ•—ï¼Œé‡è©¦ä¸­...";
            });
        }

        function render(data) {
            document.getElementById("loading").style.display = "none";
            
            // æ›´æ–°æ•¸å­—
            const countElem = document.getElementById("totalCount");
            if (data.count > previousCount) {
                countElem.style.color = "#ffff00"; 
                setTimeout(() => countElem.style.color = "#d32f2f", 500);
            }
            countElem.innerText = data.count;
            previousCount = data.count;

            // æ›´æ–°åå–®
            const grid = document.getElementById("grid");
            grid.innerHTML = ""; 

            // åè½‰é™£åˆ—ï¼Œè®“æœ€æ–°çš„åœ¨æœ€ä¸Šé¢
            const reversedList = data.list.slice().reverse();

            reversedList.forEach(person => {
                const card = document.createElement("div");
                card.className = "card";
                
                let html = `
                    <div class="info-group">
                        <div class="card-job">${person.job}</div>
                        <div class="card-name">${person.name}</div>
                    </div>`;
                
                if (person.note) {
                    html += `<div class="card-note">${person.note}</div>`;
                }

                card.innerHTML = html;
                grid.appendChild(card);
            });
        }
    </script>
</body>
</html>
